#!/bin/bash
# ============================================================================
# AudioMedic - Guia Interativo de Deploy VPS
# ============================================================================

echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo "        AudioMedic - Deploy em VPS Hostinger Privado"
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""
echo "Este guia vai te ajudar a fazer o deploy completo no seu VPS."
echo ""

# Check if running on VPS or local
if [ ! -d "/var/www" ]; then
    echo "âš ï¸  Parece que vocÃª estÃ¡ rodando localmente."
    echo ""
    echo "ğŸ“‹ CHECKLIST PRÃ‰-DEPLOY:"
    echo ""
    echo "1. VPS Contratado:"
    echo "   - [ ] VPS Hostinger ativo"
    echo "   - [ ] IP pÃºblico recebido"
    echo "   - [ ] Acesso SSH configurado"
    echo ""
    echo "2. DomÃ­nio:"
    echo "   - [ ] DomÃ­nio registrado"
    echo "   - [ ] DNS apontando para IP do VPS"
    echo "   - [ ] PropagaÃ§Ã£o DNS completa (pode levar 24h)"
    echo ""
    echo "3. MongoDB:"
    echo "   - [ ] MongoDB Atlas conta criada (recomendado)"
    echo "   - [ ] Cluster gratuito M0 criado"
    echo "   - [ ] Connection string obtido"
    echo ""
    echo "4. API Keys:"
    echo "   - [ ] OPENAI_API_KEY ou EMERGENT_LLM_KEY disponÃ­vel"
    echo ""
    echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    echo "ğŸ“¤ PRÃ“XIMO PASSO: Upload para VPS"
    echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    echo ""
    echo "OpÃ§Ã£o A: Via Git (Recomendado)"
    echo "-------------------"
    echo "1. FaÃ§a commit do projeto:"
    echo "   git init"
    echo "   git add ."
    echo "   git commit -m 'AudioMedic v2.0'"
    echo ""
    echo "2. Push para GitHub/GitLab"
    echo ""
    echo "3. No VPS, clone:"
    echo "   ssh root@SEU-IP"
    echo "   cd /var/www"
    echo "   git clone https://github.com/seu-usuario/audiomedic.git"
    echo ""
    echo "OpÃ§Ã£o B: Via SCP"
    echo "-------------------"
    echo "1. Comprimir projeto (exclua node_modules e venv):"
    echo "   tar -czf audiomedic.tar.gz --exclude='node_modules' --exclude='venv' --exclude='.git' ."
    echo ""
    echo "2. Upload para VPS:"
    echo "   scp audiomedic.tar.gz root@SEU-IP:/var/www/"
    echo ""
    echo "3. No VPS, extrair:"
    echo "   ssh root@SEU-IP"
    echo "   cd /var/www"
    echo "   mkdir audiomedic && cd audiomedic"
    echo "   tar -xzf ../audiomedic.tar.gz"
    echo ""
    echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    echo "ğŸš€ DEPOIS DO UPLOAD:"
    echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    echo ""
    echo "Execute no VPS:"
    echo ""
    echo "  cd /var/www/audiomedic"
    echo "  chmod +x deploy_hostinger.sh"
    echo "  ./deploy_hostinger.sh"
    echo ""
    echo "O script vai instalar tudo automaticamente!"
    echo ""
    echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    
else
    echo "âœ… Detectado ambiente VPS!"
    echo ""
    echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    echo "ğŸš€ INSTALAÃ‡ÃƒO AUTOMÃTICA"
    echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    echo ""
    echo "O script deploy_hostinger.sh vai:"
    echo ""
    echo "  1. âœ… Instalar Python 3.11"
    echo "  2. âœ… Instalar Node.js 18"
    echo "  3. âœ… Instalar Nginx"
    echo "  4. âœ… Instalar Supervisor"
    echo "  5. âœ… Configurar backend (venv, requirements)"
    echo "  6. âœ… Configurar frontend (build)"
    echo "  7. âœ… Configurar Supervisor"
    echo "  8. âœ… Configurar Nginx"
    echo "  9. âœ… Configurar Firewall"
    echo "  10. âœ… Instalar SSL (Certbot)"
    echo ""
    
    read -p "Deseja executar o deploy automÃ¡tico agora? (s/n): " response
    
    if [ "$response" = "s" ] || [ "$response" = "S" ]; then
        echo ""
        echo "Executando deploy..."
        chmod +x deploy_hostinger.sh
        ./deploy_hostinger.sh
    else
        echo ""
        echo "OK! Execute manualmente quando estiver pronto:"
        echo "  ./deploy_hostinger.sh"
    fi
fi

echo ""
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo "ğŸ“š DOCUMENTAÃ‡ÃƒO DISPONÃVEL:"
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""
echo "  â€¢ MIGRATE_TO_VPS.md          - Guia de migraÃ§Ã£o (este guia)"
echo "  â€¢ DEPLOY_HOSTINGER.md        - Guia completo VPS (detalhado)"
echo "  â€¢ DEPLOY_CHECKLIST.md        - Checklist de deploy"
echo "  â€¢ deploy_hostinger.sh        - Script automÃ¡tico"
echo "  â€¢ verify_deploy.sh           - Verificar apÃ³s deploy"
echo ""
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
